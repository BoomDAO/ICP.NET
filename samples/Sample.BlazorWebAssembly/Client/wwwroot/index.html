<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Sample.BlazorWebAssembly</title>
    <base href="/" />
    <link href="css/bootstrap/bootstrap.min.css" rel="stylesheet" />
    <link href="css/app.css" rel="stylesheet" />
    <link href="Sample.BlazorWebAssembly.Client.styles.css" rel="stylesheet" />
    <link href="manifest.json" rel="manifest" />
    <link rel="apple-touch-icon" sizes="512x512" href="icon-512.png" />
    <link rel="apple-touch-icon" sizes="192x192" href="icon-192.png" />
</head>

<body>
    <div id="app">Loading...</div>

    <div id="blazor-error-ui">
        An unhandled error has occurred.
        <a href="" class="reload">Reload</a>
        <a class="dismiss">ðŸ—™</a>
    </div>
    <script src="_framework/blazor.webassembly.js"></script>
    <script src="js/index.bundle.js"></script>
    <script>navigator.serviceWorker.register('service-worker.js');</script>

    <script>
        function toHexString(byteArray) {
            return byteArray.reduce((output, elem) =>
                (output + ('0' + elem.toString(16)).slice(-2)),
                '');
        }
        window.authClientLogin = function (dotNetObject) {
            window.authClient.login({
                onSuccess: () => {
                    try {
                        const identity = window.authClient.getIdentity();
                        const principalText = identity.getPrincipal().toText();
                        console.log("Pricipal Text" + principalText);
                        const publicKey = identity.getPublicKey().toDer();
                        const publicKeyHex = toHexString(new Uint8Array(publicKey));
                        console.log("Der Public Key Hex: " + publicKeyHex);
                    } catch (e) {
                        console.log(e);
                    }
                    dotNetObject.invokeMethodAsync('OnLoginSuccess');
                }
            });
        };
        window.authClientLogout = function () {
            window.authClient.logout();
        };
    </script>
</body>

</html>
